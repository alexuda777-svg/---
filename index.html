<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè∞ –¢–∞–π–Ω–∞ –ü—Ä–æ–∫–ª—è—Ç–æ–≥–æ –ó–∞–º–∫–∞</title>
    <style>
        /* CSS —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å —Ç–µ–º–∏ –∂–µ */
     *{margin:0;padding:0;box-sizing:border-box}
        body{background:linear-gradient(45deg,#1a0033,#000011);color:#e0e0ff;font-family:monospace;padding:20px;min-height:100vh}
        .container{max-width:900px;margin:0 auto}
        .header{text-align:center;background:linear-gradient(90deg,#aa00ff,#00ffff,#44ff44);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:2.5em;margin:20px 0;text-shadow:0 0 30px #aa00ff55;animation:glow 3s infinite alternate}
        @keyframes glow{0%{filter:drop-shadow(0 0 10px #aa00ff)}100%{filter:drop-shadow(0 0 20px #00ffff)}}
        .status-bar{background:rgba(0,20,60,0.95);border:2px solid #44aaff;border-radius:15px;padding:15px;margin:20px 0;display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:15px}
        .stat{text-align:center}
        .hp{color:#ff4444;font-size:1.4em;font-weight:bold}
        .strength{color:#ffaa00}
        .magic{color:#aa44ff}
        .gold{color:#ffd700}
        .scene{background:rgba(10,10,25,0.95);border:2px solid #666;border-radius:20px;padding:30px;min-height:400px;margin:20px 0;box-shadow:0 0 40px rgba(170,0,255,0.2)}
        .scene-text{line-height:1.6;font-size:1.1em}
        .highlight{background:rgba(255,255,0,0.2);padding:2px 8px;border-radius:4px;color:#ffdd44;font-weight:bold}
        .danger{color:#ff6666}
        .success{color:#44ff44}
        .magic-text{color:#aa44ff;text-shadow:0 0 10px #aa44ff}
        .choices{display:flex;flex-direction:column;gap:12px}
        .choice-btn{background:linear-gradient(135deg,#667eea,#764ba2,#f093fb);color:white;border:none;padding:20px;font-size:1.2em;border-radius:12px;cursor:pointer;transition:all .3s;box-shadow:0 8px 25px rgba(0,0,0,0.4)}
        .choice-btn:hover{transform:translateY(-5px);box-shadow:0 15px 35px rgba(102,126,234,0.6)}
        .choice-btn:disabled{opacity:0.5;transform:none!important}
        .inventory{background:rgba(0,50,20,0.9);border:2px solid #44aa44;border-radius:12px;padding:15px;margin:15px 0;display:flex;flex-wrap:wrap;gap:10px}
        .item{background:linear-gradient(45deg,#44aa44,#88dd88);color:#000;padding:8px 15px;border-radius:20px;font-weight:bold}
        .battle-log{background:rgba(80,0,0,0.95);border:2px solid #ff4444;border-radius:12px;padding:20px;margin:15px 0;max-height:200px;overflow-y:auto}
        .victory{background:linear-gradient(45deg,#44ff44,#00ff88)!important;color:#000!important}
        .defeat{background:linear-gradient(45deg,#ff4444,#ff8888)!important;color:#000!important}
        @media(max-width:600px){.status-bar{grid-template-columns:1fr}}
    </style>
</head>
<body>
    <div class="container">
        <h1 class="header" id="title">üè∞ –¢–ê–ô–ù–ê –ü–†–û–ö–õ–Ø–¢–û–ì–û –ó–ê–ú–ö–ê</h1>
        <div class="status-bar">
            <div class="stat"><div>‚öîÔ∏è <span id="player-name">–ì–µ—Ä–æ–π</span></div><div class="hp" id="hp">150/200</div></div>
            <div class="stat"><div>üí™ –°–∏–ª–∞</div><div class="strength" id="strength">100</div></div>
            <div class="stat"><div>‚ú® –ú–∞–≥–∏—è</div><div class="magic" id="magic">50</div></div>
            <div class="stat"><div>ü™ô –ó–æ–ª–æ—Ç–æ</div><div class="gold" id="gold">150</div></div>
        </div>
        <div class="scene">
            <div class="scene-text" id="scene-text">üîÆ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>
            <div class="inventory" id="inventory" style="display:none"></div>
        </div>
        <div class="choices" id="choices"></div>
        <div class="battle-log" id="battle-log" style="display:none"></div>
    </div>

    <script>
        const gameState = {
            player: {
                name: prompt('üîÆ –ò–º—è –≥–µ—Ä–æ—è:') || '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –¢–µ–Ω–µ–≥–æ–π',
                hp: 150, maxHp: 200,
                strength: 100,
                magic: 50,
                gold: 150,
                inventory: []
            },
            currentRoom: 'intro',
            battle: { active: false, enemy: null }
        };

        document.getElementById('title').textContent = `üè∞ –¢–ê–ô–ù–ê –ó–ê–ú–ö–ê | ${gameState.player.name}`;

        const gameWorld = {
            intro: {
                text: ["üåô <span class='highlight'>–ù–æ—á—å 13-–≥–æ</span>. –ì—Ä–æ–∑–∞ –Ω–∞–¥ <span class='danger'>–ó–∞–º–∫–æ–º</span>.",
                       "–¢—ã —É –≤–æ—Ä–æ—Ç. –®—ë–ø–æ—Ç –≤–µ—Ç—Ä–∞: <span class='magic-text'>'–ù–∞—Å–ª–µ–¥–Ω–∏–∫...'</span>",
                       "–û—Ç–µ—Ü –ø—Ä–æ–ø–∞–ª –∑–¥–µ—Å—å 13 –ª–µ—Ç –Ω–∞–∑–∞–¥.",
                       "üö™ –ß—Ç–æ –¥–µ–ª–∞—Ç—å?"],
                choices: [
                    {text: "‚öîÔ∏è –í–æ—Ä–≤–∞—Ç—å—Å—è —Å –±–æ–µ–º", next: 'hallway_bold'},
                    {text: "üïØÔ∏è –û—Å—Ç–æ—Ä–æ–∂–Ω–æ –≤–æ–π—Ç–∏", next: 'hallway_cautious'},
                    {text: "üõí –ú–∞–≥–∞–∑–∏–Ω", next: 'shop'}
                ]
            },
            hallway_bold: {
                text: ["‚öîÔ∏è –ó–∞–ª! <span class='danger'>–°–∫–µ–ª–µ—Ç—ã –æ–∂–∏–≤–∞—é—Ç!</span>",
                       "üé≤ <span class='highlight'>–ë–û–ô!</span>"],
                onEnter: () => startBattle('–°–∫–µ–ª–µ—Ç—ã', 80, 20),
                choices: []
            },
            hallway_cautious: {
                text: ["üïØÔ∏è –¢–∏—Ö–æ...",
                       "üíé <span class='success'>–®–∫–∞—Ç—É–ª–∫–∞!</span>",
                       "<span class='highlight'>–ö–∏–Ω–∂–∞–ª (+20 —Å–∏–ª—ã)</span> +75 –∑–æ–ª–æ—Ç–∞!"],
                onEnter: () => {
                    gameState.player.inventory.push('–ö–∏–Ω–∂–∞–ª');
                    gameState.player.gold += 75;
                    gameState.player.strength += 20;
                },
                choices: [
                    {text: "‚û°Ô∏è –î–≤–æ—Ä", next: 'courtyard'},
                    {text: "üîç –°–µ–∫—Ä–µ—Ç", next: 'secret_room'},
                    {text: "üõí –ú–∞–≥–∞–∑–∏–Ω", next: 'shop'}
                ]
            },
            shop: {
                text: ["üõí <span class='highlight'>–õ–ê–í–ö–ê</span>",
                       "üí∞ –ü–æ–∫—É–ø–∫–∏:",
                       "üíé –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∑–∞ –∑–æ–ª–æ—Ç–æ!"],
                choices: [
                    {text: "üó°Ô∏è –ú–µ—á (100 –∑–æ–ª–æ—Ç–∞) +30 —Å–∏–ª—ã", next: 'shop', cost: 100, effect: {strength: 30, item: '–ú–µ—á'}},
                    {text: "‚ú® –ö—Ä–∏—Å—Ç–∞–ª–ª (80 –∑–æ–ª–æ—Ç–∞) +40 –º–∞–≥–∏–∏", next: 'shop', cost: 80, effect: {magic: 40, item: '–ö—Ä–∏—Å—Ç–∞–ª–ª'}},
                    {text: "üßÉ –ó–µ–ª—å–µ (60 –∑–æ–ª–æ—Ç–∞) +75 HP", next: 'shop', cost: 60, effect: {hp: 75, item: '–ó–µ–ª—å–µ'}},
                    {text: "‚û°Ô∏è –î–≤–æ—Ä", next: 'courtyard'}
                ]
            },
            secret_room: {
                text: ["üîí <span class='highlight'>–°–ï–ö–†–ï–¢–ù–ê–Ø –ö–û–ú–ù–ê–¢–ê</span>",
                       "üí∞ –°–æ–∫—Ä–æ–≤–∏—â–∞: 200 –∑–æ–ª–æ—Ç–∞ + <span class='success'>–ê–º—É–ª–µ—Ç</span>",
                       "‚ú® +25 –∫–æ –≤—Å–µ–º—É!"],
                onEnter: () => {
                    gameState.player.gold += 200;
                    gameState.player.inventory.push('–ê–º—É–ª–µ—Ç');
                    gameState.player.strength += 25;
                    gameState.player.magic += 25;
                },
                choices: [
                    {text: "‚û°Ô∏è –î–≤–æ—Ä", next: 'courtyard'},
                    {text: "üõí –õ–∞–≤–∫–∞", next: 'shop'}
                ]
            },
            courtyard: {
                text: ["üåø <span class='highlight'>–î–í–û–†</span>. –¢—É–º–∞–Ω.",
                       "üëπ <span class='danger'>–ì–∞—Ä–ø–∏—è</span> —É —Å—É–Ω–¥—É–∫–∞.",
                       "–ß—Ç–æ –≤—ã–±–µ—Ä–µ—à—å?"],
                choices: [
                    {text: "‚öîÔ∏è –ì–∞—Ä–ø–∏—è (–∫–∏–Ω–∂–∞–ª)", next: 'garpia_fight', weaponReq: '–ö–∏–Ω–∂–∞–ª'},
                    {text: "üßô –ú–∞–≥–∏—è (30+)", next: 'garpia_magic', magicReq: 30},
                    {text: "üõí –õ–∞–≤–∫–∞", next: 'shop'},
                    {text: "üëë –¢—Ä–æ–Ω–Ω—ã–π –∑–∞–ª", next: 'throne_room'}
                ]
            },
            garpia_fight: {
                text: ["üó°Ô∏è <span class='highlight'>–ö–∏–Ω–∂–∞–ª vs –ì–∞—Ä–ø–∏—è!</span>",
                       "üí• <span class='danger'>–ë–û–ô!</span>"],
                onEnter: () => startBattle('–ì–∞—Ä–ø–∏—è', 120, 28),
                choices: []
            },
            garpia_magic: {
                text: ["üî• <span class='magic-text'>–í–∑—Ä—ã–≤ –º–∞–≥–∏–∏!</span>",
                       "üíé +100 –∑–æ–ª–æ—Ç–∞ + <span class='success'>–ö—Ä—ã–ª—å—è –ì–∞—Ä–ø–∏–∏</span>",
                       "‚ú® +15 –º–∞–≥–∏–∏!"],
                onEnter: () => {
                    gameState.player.gold += 100;
                    gameState.player.magic += 15;
                    gameState.player.inventory.push('–ö—Ä—ã–ª—å—è –ì–∞—Ä–ø–∏–∏');
                },
                choices: [
                    {text: "üëë –¢—Ä–æ–Ω–Ω—ã–π –∑–∞–ª", next: 'throne_room'},
                    {text: "üõí –õ–∞–≤–∫–∞", next: 'shop'}
                ]
            },
            throne_room: {
                text: ["üëë <span class='highlight'>–¢–†–û–ù–ù–´–ô –ó–ê–õ</span>",
                       "<span class='danger'>–ö–û–†–û–õ–¨ –î–ï–ú–û–ù–û–í</span> –Ω–∞ —Ç—Ä–æ–Ω–µ!",
                       "‚öîÔ∏è <span class='highlight'>–§–ò–ù–ê–õ–¨–ù–ê–Ø –ë–ò–¢–í–ê!</span>"],
                onEnter: () => startBattle('–ö–æ—Ä–æ–ª—å –î–µ–º–æ–Ω–æ–≤', 300, 40),
                choices: []
            }
        };

        function updateStatus() {
            document.getElementById('player-name').textContent = gameState.player.name;
            document.getElementById('hp').textContent = `${Math.max(0,gameState.player.hp)}/${gameState.player.maxHp}`;
            document.getElementById('strength').textContent = gameState.player.strength;
            document.getElementById('magic').textContent = gameState.player.magic;
            document.getElementById('gold').textContent = gameState.player.gold;
            
            const inv = document.getElementById('inventory');
            if (gameState.player.inventory.length) {
                inv.style.display = 'flex';
                inv.innerHTML = gameState.player.inventory.map(item => `<span class="item">${item}</span>`).join('');
            } else {
                inv.style.display = 'none';
            }
        }

        function typewriter(texts, callback) {
            const sceneText = document.getElementById('scene-text');
            sceneText.innerHTML = '';
            let currentText = '', charIndex = 0, lineIndex = 0;
            
            function typeChar() {
                if (charIndex < texts[lineIndex].length) {
                    currentText += texts[lineIndex][charIndex];
                    sceneText.innerHTML = currentText.replace(/\n/g, '<br>');
                    charIndex++;
                    setTimeout(typeChar, 40);
                } else if (lineIndex < texts.length - 1) {
                    lineIndex++;
                    charIndex = 0;
                    currentText += '<br><br>';
                    setTimeout(typeChar, 300);
                } else if (callback) {
                    callback();
                }
            }
            typeChar();
        }

        function showChoices(choices) {
            const choicesDiv = document.getElementById('choices');
            choicesDiv.innerHTML = '';
            choices.forEach(choice => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.innerHTML = choice.text;

                let canChoose = true;
                if (choice.magicReq && gameState.player.magic < choice.magicReq) canChoose = false;
                if (choice.weaponReq && !gameState.player.inventory.includes(choice.weaponReq)) canChoose = false;
                if (choice.cost && gameState.player.gold < choice.cost) canChoose = false;

                if (!canChoose) {
                    btn.disabled = true;
                } else if (choice.cost) {
                    btn.onclick = () => buyItem(choice);
                } else {
                    btn.onclick = () => selectChoice(choice);
                }
                choicesDiv.appendChild(btn);
            });
        }

        function buyItem(choice) {
            gameState.player.gold -= choice.cost;
            if (choice.effect.strength) gameState.player.strength += choice.effect.strength;
            if (choice.effect.magic) gameState.player.magic += choice.effect.magic;
            if (choice.effect.hp) gameState.player.hp = Math.min(gameState.player.maxHp, gameState.player.hp + choice.effect.hp);
            if (choice.effect.item) gameState.player.inventory.push(choice.effect.item);
            loadRoom();
        }

        function selectChoice(choice) {
            gameState.currentRoom = choice.next;
            loadRoom();
        }

        function loadRoom() {
            const room = gameWorld[gameState.currentRoom];
            if (!room) {
                gameState.currentRoom = 'courtyard';
                loadRoom();
                return;
            }
            document.getElementById('battle-log').style.display = 'none';
            typewriter(room.text, () => {
                if (room.onEnter) room.onEnter();
                showChoices(room.choices || []);
                updateStatus();
            });
        }

        function startBattle(enemyName, enemyHp, enemyStrength) {
            gameState.battle.active = true;
            gameState.battle.enemy = { name: enemyName, hp: enemyHp, maxHp: enemyHp, strength: enemyStrength };
            const battleLog = document.getElementById('battle-log');
            battleLog.style.display = 'block';
            battleLog.innerHTML = `<div class="danger">‚öîÔ∏è –ë–û–ô –° ${enemyName.toUpperCase()}!</div>`;
            battleLoop();
        }

        function battleLoop() {
            if (gameState.player.hp <= 0 || gameState.battle.enemy.hp <= 0) {
                endBattle();
                return;
            }

            const log = document.getElementById('battle-log');
            const playerDmg = Math.floor(Math.random() * (gameState.player.strength / 2)) + 15;
            gameState.battle.enemy.hp -= playerDmg;
            log.innerHTML += `<div>üí• ${gameState.player.name}: <strong>${playerDmg}</strong> —É—Ä–æ–Ω–∞!</div>`;

            if (gameState.battle.enemy.hp > 0) {
                const enemyDmg = Math.floor(Math.random() * (gameState.battle.enemy.strength / 2)) + 8;
                gameState.player.hp -= enemyDmg;
                log.innerHTML += `<div>üíÄ ${gameState.battle.enemy.name}: <strong>${enemyDmg}</strong> —É—Ä–æ–Ω–∞!</div>`;
            }

            log.innerHTML += `<div>üìä ${gameState.player.name}: ${Math.max(0,gameState.player.hp)}HP | ${gameState.battle.enemy.name}: ${Math.max(0,gameState.battle.enemy.hp)}/${gameState.battle.enemy.maxHp}HP</div>`;
            log.scrollTop = log.scrollHeight;
            updateStatus();

            if (gameState.player.hp > 0 && gameState.battle.enemy.hp > 0) {
                setTimeout(battleLoop, 1200);
            }
        }

        function endBattle() {
            const log = document.getElementById('battle-log');
            if (gameState.player.hp > 0) {
                log.innerHTML += '<div class="victory">üèÜ –ü–û–ë–ï–î–ê! +100 –∑–æ–ª–æ—Ç–∞ +25 –º–∞–≥–∏–∏!</div>';
                gameState.player.gold += 100;
                gameState.player.magic += 25;
                gameState.battle = { active: false, enemy: null };

                setTimeout(() => {
                    if (gameState.currentRoom === 'hallway_bold') {
                        gameState.currentRoom = 'courtyard';
                    } else if (gameState.currentRoom === 'garpia_fight') {
                        gameState.currentRoom = 'throne_room';
                    }
                    document.getElementById('battle-log').style.display = 'none';
                    loadRoom();
                }, 3000);
            } else {
                log.innerHTML += '<div class="defeat">üíÄ –ü–û–†–ê–ñ–ï–ù–ò–ï! –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞...</div>';
                setTimeout(() => location.reload(), 4000);
            }
        }

        updateStatus();
        loadRoom();
    </script>
</body>
</html>
