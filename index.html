<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–π–Ω–∞ –ø—Ä–æ–∫–ª—è—Ç–æ–≥–æ –∑–∞–º–∫–∞</title>
    <style>
        /* CSS —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å —Ç–∞–∫–∏–º–∏ –∂–µ */
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body{
            background: linear-gradient(45deg, #1a0033, #000011);
            color: #e0e0ff;
            font-family: monospace;
            padding: 20px;
            min-height: 100vh;
        }
        .container{
            max-width: 900px;
            margin: 0 auto;
        }
        .header{
            text-align: center;
            background: linear-gradient(90deg, #aa00ff, #00ffff, #44ff44);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.5em;
            margin: 20px 0;
            text-shadow: 0 0 30px #aa00ff55;
            animation: glow 3s infinite alternate;
        }
        @keyframes glow{
            0%{
                filter: drop-shadow(0 0 10px #aa00ff)
            }
            100%{
                filter: drop-shadow(0 0 20px #00ffff)
            }
        }
        .status-bar{
            background: rgba(0, 20, 60, 0.95);
            border: 2px solid #44aaff;
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 15px;
        }
        .stat{
            text-align: center;
        }
        .hp{
            color: #ff4444;
            font-size: 1.4em;
            font-weight: bold;
        }
        .strength{
            color: #ffaa00;
        }
        .magic{
            color: #aa44ff;
        }
        .gold{
            color: #ffd700;
        }
        .scene{
            background: rgba(10, 10, 25, 0.95);
            border: 2px solid #666;
            border-radius: 20px;
            padding: 30px;
            min-height: 400px;
            margin: 20px 0;
            box-shadow: 0 0 40px rgba(170, 0, 255, 0.2);
        }
        .scene-text{
            line-height: 1.6;
            font-size: 1.1em;
        }
        .highlight{
            background: rgba(255, 255, 0, 0.2);
            padding: 2px 8px;
            border-radius: 4px;
            color: #ffdd44;
            font-weight: bold;
        }
        .danger{
            color: #ff6666;
        }
        .success{
            color: #44ff44;
        }
        .magic-text{
            color: #aa44ff;
            text-shadow: 0 0 10px #aa44ff;
        }
        .choices{
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .choice-btn{
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
            color: white;
            border: none;
            padding: 20px;
            font-size: 1.2em;
            border-radius: 12px;
            cursor: pointer;
            transition: all .3s;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }
        .choice-btn:hover{
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.6);
        }
        .inventory{
            background: rgba(0, 50, 20, 0.9);
            border: 2px solid #44aa44;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .item{
            background: linear-gradient(45deg, #44aa44, #88dd88);
            color: #000;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
        }
        .battle-log{
            background: rgba(80, 0, 0, 0.95);
            border: 2px solid #ff4444;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            max-height: 200px;
            overflow-y: auto;
        }
        .victory{
            background: linear-gradient(45deg, #44ff44, #00ff88) !important;
            color: #000 !important;
        }
        .defeat{
            background: linear-gradient(45deg, #ff4444, #ff8888) !important;
            color: #000 !important;
        }
        @media (max-width: 600px){
            .status-bar{
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="header" id="title">üè∞ –¢–ê–ô–ù–ê –ü–†–û–ö–õ–Ø–¢–û–ì–û –ó–ê–ú–ö–ê</h1>
        <div class="status-bar">
            <div class="stat">
                <div>‚öîÔ∏è <span id="player-name">–ì–µ—Ä–æ–π</span></div>
                <div class="hp" id="hp">150/200</div>
            </div>
            <div class="stat">
                <div>üí™ –°–∏–ª–∞</div>
                <div class="strength" id="strength">100</div>
            </div>
            <div class="stat">
                <div>‚ú® –ú–∞–≥–∏—è</div>
                <div class="magic" id="magic">50</div>
            </div>
            <div class="stat">
                <div>ü™ô –ó–æ–ª–æ—Ç–æ</div>
                <div class="gold" id="gold">150</div>
            </div>
        </div>
        <div class="scene">
            <div class="scene-text" id="scene-text">üîÆ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–π –º–∞–≥–∏–∏...</div>
            <div class="inventory" id="inventory" style="display: none"></div>
        </div>
        <div class="choices" id="choices"></div>
        <div class="battle-log" id="battle-log" style="display: none"></div>
    </div>

    <script>
        const gameState = {
            player: {
                name: prompt('üîÆ –ò–º—è –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –≥–µ—Ä–æ—è:') || '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –¢–µ–Ω–µ–≥–æ–π',
                hp: 150,
                maxHp: 200,
                strength: 100,
                magic: 50,
                gold: 150,
                inventory: [],
                damageDealt: 0,       // –û–±—â–∞—è —Å—É–º–º–∞ –Ω–∞–Ω–µ—Å—ë–Ω–Ω–æ–≥–æ —É—Ä–æ–Ω–∞
                damageReceived: 0     // –û–±—â–∞—è —Å—É–º–º–∞ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–Ω–∞
            },
            currentRoom: 'intro',
            battleActive: false,
            battleEnemy: null
        };

        document.getElementById('title').textContent = `üè∞ –¢–ê–ô–ù–ê –ó–ê–ú–ö–ê | ${gameState.player.name}`;

        const gameWorld = {
            intro: {
                text: ["üåô <span class='highlight'>–ù–æ—á—å 13-–≥–æ</span>. –ì—Ä–æ–∑–∞ –Ω–∞–¥ <span class='danger'>–ü—Ä–æ–∫–ª—è—Ç—ã–º –ó–∞–º–∫–æ–º</span>.",
                       "–¢—ã —Å—Ç–æ–∏—à—å —É —á–µ—Ä–Ω—ã—Ö –≤—Ä–∞—Ç. –í–µ—Ç–µ—Ä —à–µ–ø—á–µ—Ç: <span class='magic-text'>'–ù–∞—Å–ª–µ–¥–Ω–∏–∫... –∏–¥–∏...'</span>",
                       "–û—Ç–µ—Ü –ø—Ä–æ–ø–∞–ª –∑–¥–µ—Å—å 13 –ª–µ—Ç –Ω–∞–∑–∞–¥. –ö–æ–º–ø–∞—Å –≤ —Ä—É–∫–µ <span class='highlight'>—Ç—Ä–µ–ø–µ—â–µ—Ç</span>.",
                       "üö™ –ß—Ç–æ –¥–µ–ª–∞—Ç—å?" ],
                choices: [{text: "‚öîÔ∏è –í–æ—Ä–≤–∞—Ç—å—Å—è —Å –±–æ–µ–º", next: 'hallway_bold'},
                          {text: "üïØÔ∏è –û—Å—Ç–æ—Ä–æ–∂–Ω–æ –≤–æ–π—Ç–∏", next: 'hallway_cautious'},
                          {text: "üõí –ú–∞–≥–∞–∑–∏–Ω —Ç–æ—Ä–≥–æ–≤—Ü–∞", next: 'shop'}]
            },
            hallway_bold: {
                text: ["‚öîÔ∏è –¢—ã –≤—Ä—ã–≤–∞–µ—à—å—Å—è –≤ –≥–ª–∞–≤–Ω—ã–π –∑–∞–ª!",
                       "üíÄ <span class='danger'>–¢—Ä–∏ —Å–∫–µ–ª–µ—Ç–∞-—Å—Ç—Ä–∞–∂–∞</span> –æ–∂–∏–≤–∞—é—Ç!",
                       "üé≤ <span class='highlight'>–ë–ò–¢–í–ê –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø!</span>" ],
                onEnter: () => startBattle('–°–∫–µ–ª–µ—Ç—ã-—Å—Ç—Ä–∞–∂–∏', 80, 20),
                choices: []
            },
            hallway_cautious: {
                text: ["üïØÔ∏è –¢—ã –∫—Ä–∞–¥–µ—à—å—Å—è –ø–æ –∫–æ—Ä–∏–¥–æ—Ä—É...",
                       "üíé –ù–∞—Ö–æ–¥–∏—à—å <span class='success'>—Å—Ç–∞—Ä—É—é —à–∫–∞—Ç—É–ª–∫—É</span>!",
                       "‚ú® <span class='highlight'>–ö–∏–Ω–∂–∞–ª –∞—Å—Å–∞—Å–∏–Ω–∞ (+20 —Å–∏–ª—ã)</span> +75 –∑–æ–ª–æ—Ç–∞!" ],
                onEnter: () => {
                    gameState.player.inventory.push('–ö–∏–Ω–∂–∞–ª –∞—Å—Å–∞—Å–∏–Ω–∞');
                    gameState.player.gold += 75;
                    gameState.player.strength += 20;
                },
                choices: [{text: "‚û°Ô∏è –í–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–≤–æ—Ä", next: 'courtyard'},
                          {text: "üîç –°–µ–∫—Ä–µ—Ç–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞", next: 'secret_room'},
                          {text: "üõí –ú–∞–≥–∞–∑–∏–Ω", next: 'shop'}]
            },
            shop: {
                text: ["üõí <span class='highlight'>–¢–ê–ò–ù–°–¢–í–ï–ù–ù–´–ô –¢–û–†–ì–û–í–ï–¶</span>",
                       "üí∞ '–í—ã–±–µ—Ä–∏ —Ç–æ–≤–∞—Ä, –≥–µ—Ä–æ–π:'",
                       "üíé –†–µ–¥–∫–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∑–∞ –∑–æ–ª–æ—Ç–æ!" ],
                choices: [
                    {text: "üó°Ô∏è –û–≥–Ω–µ–Ω–Ω—ã–π –º–µ—á (100 –∑–æ–ª–æ—Ç–∞) +30 —Å–∏–ª—ã", next: 'shop', cost: 100, effect: {strength: 30, item: '–û–≥–Ω–µ–Ω–Ω—ã–π –º–µ—á'}},
                    {text: "‚ú® –ö—Ä–∏—Å—Ç–∞–ª–ª –º–∞–Ω—ã (80 –∑–æ–ª–æ—Ç–∞) +40 –º–∞–≥–∏–∏", next: 'shop', cost: 80, effect: {magic: 40, item: '–ö—Ä–∏—Å—Ç–∞–ª–ª –º–∞–Ω—ã'}},
                    {text: "üß™ –°—É–ø–µ—Ä-–∑–µ–ª—å–µ (60 –∑–æ–ª–æ—Ç–∞) +75 HP", next: 'shop', cost: 60, effect: {hp: 75, item: '–°—É–ø–µ—Ä-–∑–µ–ª—å–µ'}},
                    {text: "‚û°Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—É—Ç—å", next: 'courtyard'}
                ]
            },
            secret_room: {
                text: ["üîí <span class='highlight'>–°–ï–ö–†–ï–¢–ù–ê–Ø –ö–û–ú–ù–ê–¢–ê</span> —Å –¥—Ä–µ–≤–Ω–∏–º–∏ —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏!",
                       "üí∞ <span class='success'>200 –∑–æ–ª–æ—Ç–∞</span> + <span class='highlight'>–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –∞–º—É–ª–µ—Ç</span>",
                       "‚ú® +25 –∫–æ –≤—Å–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º!" ],
                onEnter: () => {
                    gameState.player.gold += 200;
                    gameState.player.inventory.push('–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –∞–º—É–ª–µ—Ç');
                    gameState.player.strength += 25;
                    gameState.player.magic += 25;
                },
                choices: [{text: "‚û°Ô∏è –í–æ –¥–≤–æ—Ä", next: 'courtyard'},
                          {text: "üõí –ú–∞–≥–∞–∑–∏–Ω", next: 'shop'}]
            },
            courtyard: {
                text: ["üåø <span class='highlight'>–í–ù–£–¢–†–ï–ù–ù–ò–ô –î–í–û–†</span>. –¢—É–º–∞–Ω —Å—Ç–µ–ª–µ—Ç—Å—è –ø–æ –∑–µ–º–ª–µ.",
                       "üëπ <span class='danger'>–ì–∞—Ä–ø–∏—è</span> –æ—Ö—Ä–∞–Ω—è–µ—Ç –º–∞–≥–∏—á–µ—Å–∫–∏–π —Å—É–Ω–¥—É–∫.",
                       "üó°Ô∏è –ï—Å—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–µ–µ –æ—Ä—É–∂–∏–µ?" ],
                choices: [{text: "‚öîÔ∏è –°—Ä–∞–∑–∏—Ç—å—Å—è —Å –≥–∞—Ä–ø–∏–µ–π", next: 'garpia_fight', weaponReq: '–ö–∏–Ω–∂–∞–ª –∞—Å—Å–∞—Å–∏–Ω–∞'},
                          {text: "üßô‚Äç‚ôÇÔ∏è –ú–∞–≥–∏—á–µ—Å–∫–∏–π —É–¥–∞—Ä", next: 'garpia_magic', magicReq: 30},
                          {text: "üõí –ú–∞–≥–∞–∑–∏–Ω", next: 'shop'},
                          {text: "üëë –ö —Ç—Ä–æ–Ω–Ω–æ–º—É –∑–∞–ª—É", next: 'throne_room'}]
            },
            garpia_fight: {
                text: ["üó°Ô∏è <span class='highlight'>–ö–∏–Ω–∂–∞–ª –∞—Å—Å–∞—Å–∏–Ω–∞ –ø—Ä–æ—Ç–∏–≤ –ì–∞—Ä–ø–∏–∏!</span>",
                       "üí• <span class='danger'>–ë–∏—Ç–≤–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è!</span>" ],
                onEnter: () => startBattle('–ì–∞—Ä–ø–∏—è', 120, 28),
                choices: []
            },
            garpia_magic: {
                text: ["üî• <span class='magic-text'>–û–ì–ù–ï–ù–ù–´–ô –í–ó–†–´–í!</span> –ì–∞—Ä–ø–∏—è –∏—Å–ø–µ–ø–µ–ª–µ–Ω–∞!",
                       "üíé <span class='success'>–°—É–Ω–¥—É–∫ –æ—Ç–∫—Ä—ã—Ç: 100 –∑–æ–ª–æ—Ç–∞</span> + <span class='highlight'>–ö—Ä—ã–ª—å—è –ì–∞—Ä–ø–∏–∏</span>",
                       "‚ú® +15 –º–∞–≥–∏–∏!" ],
                onEnter: () => {
                    gameState.player.gold += 100;
                    gameState.player.magic += 15;
                    gameState.player.inventory.push('–ö—Ä—ã–ª—å—è –ì–∞—Ä–ø–∏–∏');
                },
                choices: [{text: "üëë –ö —Ç—Ä–æ–Ω–Ω–æ–º—É –∑–∞–ª—É", next: 'throne_room'},
                          {text: "üõí –ú–∞–≥–∞–∑–∏–Ω", next: 'shop'}]
            },
            throne_room: {
                text: ["üëë <span class='highlight'>–¢–†–û–ù–ù–´–ô –ó–ê–õ</span>. –í —Ü–µ–Ω—Ç—Ä–µ ‚Äî <span class='danger'>–ö–û–†–û–õ–¨ –î–ï–ú–û–ù–û–í</span>!",
                       "ü™® –û–Ω –≤–æ—Å—Å–µ–¥–∞–µ—Ç –Ω–∞ —Ç—Ä–æ–Ω–µ –∏–∑ –∫–æ—Å—Ç–µ–π. –ì–ª–∞–∑–∞ –ø—ã–ª–∞—é—Ç <span class='magic-text'>–∞–¥—Å–∫–∏–º –ø–ª–∞–º–µ–Ω–µ–º</span>.",
                       "‚öîÔ∏è <span class='highlight'>–§–ò–ù–ê–õ–¨–ù–ê–Ø –ë–ò–¢–í–ê!</span>" ],
                onEnter: () => startBattle('–ö–æ—Ä–æ–ª—å –î–µ–º–æ–Ω–æ–≤', 300, 40),
                choices: []
            }
        };

        function updateStatus() {
            document.getElementById('player-name').textContent = gameState.player.name;
            document.getElementById('hp').textContent = `${Math.max(0, gameState.player.hp)}/${gameState.player.maxHp}`;
            document.getElementById('strength').textContent = gameState.player.strength;
            document.getElementById('magic').textContent = gameState.player.magic;
            document.getElementById('gold').textContent = gameState.player.gold;
            const inv = document.getElementById('inventory');
            if (gameState.player.inventory.length) {
                inv.style.display = 'flex';
                inv.innerHTML = gameState.player.inventory.map(item => `<span class="item">${item}</span>`).join('');
            } else {
                inv.style.display = 'none';
            }
        }

        function typewriter(texts, callback) {
            const sceneText = document.getElementById('scene-text');
            sceneText.innerHTML = '';
            let currentText = '', charIndex = 0, lineIndex = 0;
            function typeChar() {
                if (charIndex < texts[lineIndex].length) {
                    currentText += texts[lineIndex][charIndex];
                    sceneText.innerHTML = currentText.replace(/\n/g, '<br>');
                    charIndex++;
                    setTimeout(typeChar, 40);
                } else if (lineIndex < texts.length - 1) {
                    lineIndex++;
                    charIndex = 0;
                    currentText += '<br><br>';
                    setTimeout(typeChar, 300);
                } else if (callback) {
                    callback();
                }
            }
            typeChar();
        }

        function showChoices(choices) {
            const choicesDiv = document.getElementById('choices');
            choicesDiv.innerHTML = '';
            choices.forEach(choice => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.innerHTML = choice.text;

                let isAvailable = true;
                if (choice.magicReq && gameState.player.magic < choice.magicReq) {
                    isAvailable = false;
                }
                if (choice.weaponReq && !gameState.player.inventory.includes(choice.weaponReq)) {
                    isAvailable = false;
                }
                if (choice.cost && gameState.player.gold < choice.cost) {
                    isAvailable = false;
                }

                if (!isAvailable) {
                    btn.style.opacity = '.5';
                    btn.disabled = true;
                    btn.title = '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤';
                } else {
                    btn.onclick = () => selectChoice(choice);
                }

                choicesDiv.appendChild(btn);
            });
        }

        function buyItem(choice) {
            gameState.player.gold -= choice.cost;
            if (choice.effect.strength) gameState.player.strength += choice.effect.strength;
            if (choice.effect.magic) gameState.player.magic += choice.effect.magic;
            if (choice.effect.hp) gameState.player.hp = Math.min(gameState.player.maxHp, gameState.player.hp + choice.effect.hp);
            if (choice.effect.item) gameState.player.inventory.push(choice.effect.item);
            loadRoom();
        }

        function selectChoice(choice) {
            gameState.currentRoom = choice.next;
            loadRoom();
        }

        function loadRoom() {
            const room = gameWorld[gameState.currentRoom];
            if (!room) {
                gameState.currentRoom = 'courtyard';
                loadRoom();
                return;
            }
            document.getElementById('battle-log').style.display = 'none';
            typewriter(room.text, () => {
                if (room.onEnter) room.onEnter();
                showChoices(room.choices || []);
                updateStatus();
            });
        }

        function startBattle(enemyName, enemyHp, enemyStrength) {
            gameState.battleActive = true;
            gameState.battleEnemy = { name: enemyName, hp: enemyHp, maxHp: enemyHp, strength: enemyStrength };
            const battleLog = document.getElementById('battle-log');
            battleLog.style.display = 'block';
            battleLog.innerHTML = `<div class="danger">‚öîÔ∏è –ë–û–ô –° <span style="color:#ffdd44">${enemyName.toUpperCase()}</span>!</div>`;
            battleLog.scrollTop = battleLog.scrollHeight;
            battleLoop();
        }

        function battleLoop() {
            if (gameState.player.hp <= 0 || gameState.battleEnemy.hp <= 0) {
                endBattle();
                return;
            }

            const log = document.getElementById('battle-log');
            // –†–∞—Å—á—ë—Ç —É—Ä–æ–Ω–∞ –∏–≥—Ä–æ–∫–∞
            const playerDmg = Math.floor(Math.random() * gameState.player.strength / 2) + 15;
            gameState.battleEnemy.hp -= playerDmg;
            gameState.player.damageDealt += playerDmg; // –∑–∞–ø–æ–º–∏–Ω–∞–µ–º –Ω–∞–Ω–µ—Å—ë–Ω–Ω—ã–π —É—Ä–æ–Ω
            log.innerHTML += `<div>üí• <span class="success">${gameState.player.name}</span> –Ω–∞–Ω—ë—Å <strong>${playerDmg}</strong> —É—Ä–æ–Ω–∞!</div>`;

            // –£—Ä–æ–Ω –≤—Ä–∞–≥–∞
            if (gameState.battleEnemy.hp > 0) {
                const enemyDmg = Math.floor(Math.random() * gameState.battleEnemy.strength / 2) + 8;
                gameState.player.hp -= enemyDmg;
                gameState.player.damageReceived += enemyDmg; // –∑–∞–ø–æ–º–∏–Ω–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —É—Ä–æ–Ω
                log.innerHTML += `<div>üíÄ <span class="danger">${gameState.battleEnemy.name}</span> –Ω–∞–Ω—ë—Å <strong>${enemyDmg}</strong> —É—Ä–æ–Ω–∞!</div>`;
            }

            log.innerHTML += `<div>üìä ${gameState.player.name}: ${Math.max(0, gameState.player.hp)}/${gameState.player.maxHp}HP | ${gameState.battleEnemy.name}: ${Math.max(0, gameState.battleEnemy.hp)}/${gameState.battleEnemy.maxHp}HP</div>`;
            log.scrollTop = log.scrollHeight;
            updateStatus();

            if (gameState.player.hp > 0 && gameState.battleEnemy.hp > 0) {
                setTimeout(battleLoop, 1200);
            }
        }

        function endBattle() {
    const log = document.getElementById('battle-log');
    if (gameState.player.hp > 0) {
        log.innerHTML += `
            <div class="victory">
                üèÜ <strong>–ü–æ–±–µ–¥–∞!</strong>
                <br/>–ü–æ–ª—É—á–µ–Ω–æ: +100 –∑–æ–ª–æ—Ç–∞, +25 –º–∞–≥–∏–∏.<br/>
                –í–∞—à —É—Ä–æ–Ω: <strong>${gameState.player.damageDealt}</strong>.<br/>
                –ü–æ–ª—É—á–µ–Ω–Ω—ã–π —É—Ä–æ–Ω: <strong>${gameState.player.damageReceived}</strong>.<br/>
                –û—Å—Ç–∞–≤—à–µ–µ—Å—è –∑–¥–æ—Ä–æ–≤—å–µ: <strong>${gameState.player.hp}/${gameState.player.maxHp}</strong>HP.
            </div>
        `;
        gameState.player.gold += 100;
        gameState.player.magic += 25;
        gameState.battleActive = false;
        gameState.battleEnemy = null;

        // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ –≤—ã–∏–≥—Ä–∞–ª, –ø–µ—Ä–µ–≤–æ–¥–∏–º –µ–≥–æ –≤ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–Ω–∞—Ç—É
        switch (gameState.currentRoom) {
            case 'hallway_bold': // –ü–æ–±–µ–¥–∞ –≤ –≥–ª–∞–≤–Ω–æ–º –∑–∞–ª–µ
                gameState.currentRoom = 'courtyard'; // –ü–µ—Ä–µ—Ö–æ–¥ –≤ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–≤–æ—Ä
                break;
            case 'garpia_fight': // –ü–æ–±–µ–¥–∞ –Ω–∞–¥ –≥–∞—Ä–ø–∏–µ–π
                gameState.currentRoom = 'throne_room'; // –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Ç—Ä–æ–Ω–Ω—ã–π –∑–∞–ª
                break;
            default:
                console.log('–ù–µ –Ω–∞–π–¥–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–º–Ω–∞—Ç–∞ –ø–æ—Å–ª–µ –ø–æ–±–µ–¥—ã!');
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–±–æ—Ä–∞ –ø–æ—Å–ª–µ –±–æ—è
        showChoicesAfterBattle();
    } else {
        // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ –ø—Ä–æ–∏–≥—Ä–∞–ª, –≤—ã–≤–µ–¥–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ—Ä–∞–∂–µ–Ω–∏–∏
        handleDefeat();
    }
}

        function showChoicesAfterBattle() {
    const room = gameWorld[gameState.currentRoom]; // –¢–µ–∫—É—â–∞—è –∫–æ–º–Ω–∞—Ç–∞
    if (room && room.choices) {
        showChoices(room.choices); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤—ã–±–æ—Ä—ã
    } else {
        console.error('–û—à–∏–±–∫–∞: –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ—Å–ª–µ –±–æ—è.');
    }

    // –ü–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –≤—ã–±–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∏–º –Ω–æ–≤—É—é –∫–æ–º–Ω–∞—Ç—É
    loadRoom();
}
 
<script>
        // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã –∏ –∏–≥—Ä–æ–≤–æ–≥–æ –º–∏—Ä–∞
        const gameState = {
            player: {
                name: prompt('üîÆ –ò–º—è –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –≥–µ—Ä–æ—è:') || '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –¢–µ–Ω–µ–≥–æ–π',
                hp: 150,
                maxHp: 200,
                strength: 100,
                magic: 50,
                gold: 150,
                inventory: [],
                damageDealt: 0,       // –û–±—â–∞—è —Å—É–º–º–∞ –Ω–∞–Ω–µ—Å—ë–Ω–Ω–æ–≥–æ —É—Ä–æ–Ω–∞
                damageReceived: 0     // –û–±—â–∞—è —Å—É–º–º–∞ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–Ω–∞
            },
            currentRoom: 'intro',
            battleActive: false,
            battleEnemy: null
        };

        document.getElementById('title').textContent = `üè∞ –¢–ê–ô–ù–ê –ó–ê–ú–ö–ê | ${gameState.player.name}`;

        const gameWorld = {
            intro: {
                text: ["–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ü–µ–Ω–∞", "–í–∞—à–∞ –∑–∞–¥–∞—á–∞...", "..."],
                choices: [...]
            },
            hallway_bold: {
                text: ["–û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ª", "–û–ø–∞—Å–Ω–æ—Å—Ç—å –≤–ø–µ—Ä–µ–¥–∏", "..."],
                onEnter: () => startBattle('–í—Ä–∞–≥', 100, 20),
                choices: []
            },
            // –∏ –¥—Ä—É–≥–∏–µ –∫–æ–º–Ω–∞—Ç—ã...
        };

        // 2. –û—Å–Ω–æ–≤–Ω—ã–µ –∏–≥—Ä–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function updateStatus() {}
        function typewriter() {}
        function showChoices() {}
        function buyItem() {}
        function selectChoice() {}
        function loadRoom() {}
        function startBattle() {}
        function battleLoop() {}
        function endBattle() {}

        // 3. –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function handleDefeat() {
            const log = document.getElementById('battle-log');
            log.innerHTML += '<div class="defeat">üíÄ <strong>–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!</strong> –í—ã –ø–æ–≥–∏–±–ª–∏.</div>';
            
            // –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –≤—ã–±–æ—Ä: –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –∏–≥—Ä—É –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è –≤ –º–∞–≥–∞–∑–∏–Ω
            const choicesDiv = document.getElementById('choices');
            choicesDiv.innerHTML = ''; // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∫–Ω–æ–ø–∫–∏
            const restartBtn = document.createElement('button');
            restartBtn.className = 'choice-btn';
            restartBtn.innerHTML = '‚≠ê –í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –∏–≥—Ä—É';
            restartBtn.onclick = () => reloadGame();
            choicesDiv.appendChild(restartBtn);
            
            const goShopBtn = document.createElement('button');
            goShopBtn.className = 'choice-btn';
            goShopBtn.innerHTML = 'üõí –û—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è –≤ –º–∞–≥–∞–∑–∏–Ω';
            goShopBtn.onclick = () => {
                gameState.currentRoom = 'shop';
                loadRoom();
            };
            choicesDiv.appendChild(goShopBtn);
        }

        function reloadGame() {
            window.location.reload();
        }
        // 4. –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
        updateStatus();
        loadRoom();
    </script>
</body>
</html>
